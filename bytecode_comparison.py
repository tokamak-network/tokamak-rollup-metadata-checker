#!/usr/bin/env python3
"""
바이트코드 비교 도구
두 스마트 컨트랙트 바이트코드의 차이점을 분석합니다.
"""

import re
from typing import List, Tuple, Dict

def extract_addresses(bytecode: str) -> List[str]:
    """바이트코드에서 주소 패턴을 추출합니다."""
    # 0x로 시작하는 40자리 16진수 주소 패턴 찾기
    pattern = r'0x[a-fA-F0-9]{40}'
    addresses = re.findall(pattern, bytecode)
    return addresses

def find_all_differences(bytecode1: str, bytecode2: str) -> List[int]:
    """두 바이트코드에서 모든 차이점의 위치를 찾습니다."""
    differences = []
    for i, (b1, b2) in enumerate(zip(bytecode1, bytecode2)):
        if b1 != b2:
            differences.append(i)
    return differences

def compare_bytecodes(bytecode1: str, bytecode2: str) -> Dict:
    """두 바이트코드를 비교하여 차이점을 분석합니다."""

    # 주소 추출
    addresses1 = extract_addresses(bytecode1)
    addresses2 = extract_addresses(bytecode2)

    # 고유한 주소들
    unique_addresses1 = list(set(addresses1))
    unique_addresses2 = list(set(addresses2))

    # 모든 차이점 찾기
    all_differences = find_all_differences(bytecode1, bytecode2)

    # 차이점 분석
    differences = {
        'total_length_1': len(bytecode1),
        'total_length_2': len(bytecode2),
        'addresses_1': unique_addresses1,
        'addresses_2': unique_addresses2,
        'common_addresses': list(set(unique_addresses1) & set(unique_addresses2)),
        'only_in_1': list(set(unique_addresses1) - set(unique_addresses2)),
        'only_in_2': list(set(unique_addresses2) - set(unique_addresses1)),
        'length_difference': abs(len(bytecode1) - len(bytecode2)),
        'all_differences': all_differences,
        'first_difference': all_differences[0] if all_differences else None
    }

    return differences

def analyze_differences(bytecode1: str, bytecode2: str):
    """바이트코드 차이점을 상세히 분석합니다."""

    print("=== 바이트코드 비교 분석 ===\n")

    # 기본 비교
    diff = compare_bytecodes(bytecode1, bytecode2)

    print(f"바이트코드 1 길이: {diff['total_length_1']} 문자")
    print(f"바이트코드 2 길이: {diff['total_length_2']} 문자")
    print(f"길이 차이: {diff['length_difference']} 문자")
    print(f"총 차이점 수: {len(diff['all_differences'])}")

    if diff['first_difference'] is not None:
        print(f"첫 번째 차이점 위치: {diff['first_difference']}번째 문자")

        # 차이점 주변 컨텍스트 표시
        start = max(0, diff['first_difference'] - 20)
        end1 = min(len(bytecode1), diff['first_difference'] + 20)
        end2 = min(len(bytecode2), diff['first_difference'] + 20)

        print(f"\n차이점 주변 컨텍스트:")
        print(f"바이트코드 1: ...{bytecode1[start:end1]}...")
        print(f"바이트코드 2: ...{bytecode2[start:end2]}...")

    print(f"\n=== 주소 분석 ===")
    print(f"바이트코드 1의 고유 주소: {diff['addresses_1']}")
    print(f"바이트코드 2의 고유 주소: {diff['addresses_2']}")
    print(f"공통 주소 수: {len(diff['common_addresses'])}")

    if diff['only_in_1']:
        print(f"\n바이트코드 1에만 있는 주소:")
        for addr in diff['only_in_1']:
            print(f"  {addr}")

    if diff['only_in_2']:
        print(f"\n바이트코드 2에만 있는 주소:")
        for addr in diff['only_in_2']:
            print(f"  {addr}")

    # 주소 변경 패턴 분석
    if len(diff['addresses_1']) == len(diff['addresses_2']) and len(diff['addresses_1']) > 0:
        print(f"\n=== 주소 변경 패턴 ===")
        for i, (addr1, addr2) in enumerate(zip(diff['addresses_1'], diff['addresses_2'])):
            if addr1 != addr2:
                print(f"주소 변경: {addr1} → {addr2}")
                print(f"  변경된 부분: {addr1[2:]} → {addr2[2:]}")  # 0x 제외하고 비교

    # 연속된 차이점 그룹 분석
    if diff['all_differences']:
        print(f"\n=== 차이점 패턴 분석 ===")
        consecutive_groups = []
        current_group = [diff['all_differences'][0]]

        for i in range(1, len(diff['all_differences'])):
            if diff['all_differences'][i] == diff['all_differences'][i-1] + 1:
                current_group.append(diff['all_differences'][i])
            else:
                consecutive_groups.append(current_group)
                current_group = [diff['all_differences'][i]]

        consecutive_groups.append(current_group)

        for i, group in enumerate(consecutive_groups):
            print(f"연속 차이점 그룹 {i+1}: 위치 {group[0]}-{group[-1]} (길이: {len(group)})")

            # 각 그룹의 실제 값 비교
            start_pos = group[0]
            end_pos = group[-1] + 1
            val1 = bytecode1[start_pos:end_pos]
            val2 = bytecode2[start_pos:end_pos]
            print(f"  바이트코드 1: {val1}")
            print(f"  바이트코드 2: {val2}")

def main():

    # # L1FeeVault
    # # 첫 번째 바이트코드 (첨부된 파일에서)
    # bytecode1 = "0x6080604052600436106100695760003560e01c806384411d651161004357806384411d6514610140578063d0e12f9014610164578063d3e5792b146101a557600080fd5b80630d9019e1146100755780633ccfd60b146100d357806354fd4d50146100ea57600080fd5b3661007057005b600080fd5b34801561008157600080fd5b506100a97f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e981565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100df57600080fd5b506100e86101d9565b005b3480156100f657600080fd5b506101336040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100ca9190610633565b34801561014c57600080fd5b5061015660005481565b6040519081526020016100ca565b34801561017057600080fd5b506101987f000000000000000000000000000000000000000000000000000000000000000081565b6040516100ca91906106b7565b3480156101b157600080fd5b506101567f0000000000000000000000000000000000000000000000008ac7230489e8000081565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546102ca91906106cb565b9091555050604080518281527f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e9337f00000000000000000000000000000000000000000000000000000000000000006040516103b8949392919061070a565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156103f4576103f461064d565b0361050d5760007f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d8060008114610473576040519150601f19603f3d011682016040523d82523d6000602084013e610478565b606091505b5050905080610509576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102ab565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a3918491610593917f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e99184916188b8919060040161074b565b6000604051808303818588803b1580156105ac57600080fd5b505af11580156105c0573d6000803e3d6000fd5b505050505050565b6000815180845260005b818110156105ee576020818501810151868301820152016105d2565b81811115610600576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b60208152600061064660208301846105c8565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106b3577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b602081016106c5828461067c565b92915050565b60008219821115610705577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff84811660208301528316604082015260808101610742606083018461067c565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff8316604082015260806060820152600061078c60808301846105c8565b969550505050505056fea164736f6c634300080f000a"

    # # 두 번째 바이트코드 (사용자가 제공한 것)
    # bytecode2 = "0x6080604052600436106100695760003560e01c806384411d651161004357806384411d6514610140578063d0e12f9014610164578063d3e5792b146101a557600080fd5b80630d9019e1146100755780633ccfd60b146100d357806354fd4d50146100ea57600080fd5b3661007057005b600080fd5b34801561008157600080fd5b506100a97f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174281565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100df57600080fd5b506100e86101d9565b005b3480156100f657600080fd5b506101336040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100ca9190610633565b34801561014c57600080fd5b5061015660005481565b6040519081526020016100ca565b34801561017057600080fd5b506101987f000000000000000000000000000000000000000000000000000000000000000081565b6040516100ca91906106b7565b3480156101b157600080fd5b506101567f0000000000000000000000000000000000000000000000008ac7230489e8000081565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546102ca91906106cb565b9091555050604080518281527f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b401742337f00000000000000000000000000000000000000000000000000000000000000006040516103b8949392919061070a565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156103f4576103f461064d565b0361050d5760007f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d8060008114610473576040519150601f19603f3d011682016040523d82523d6000602084013e610478565b606091505b5050905080610509576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102ab565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a3918491610593917f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b4017429184916188b8919060040161074b565b6000604051808303818588803b1580156105ac57600080fd5b505af11580156105c0573d6000803e3d6000fd5b505050505050565b6000815180845260005b818110156105ee576020818501810151868301820152016105d2565b81811115610600576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b60208152600061064660208301846105c8565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106b3577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b602081016106c5828461067c565b92915050565b60008219821115610705577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff84811660208301528316604082015260808101610742606083018461067c565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff8316604082015260806060820152600061078c60808301846105c8565b969550505050505056fea164736f6c634300080f000a"

    # SequencerFeeVault
    # 첫 번째 바이트코드 (첨부된 파일에서)
    bytecode1 = "0x6080604052600436106100745760003560e01c806384411d651161004e57806384411d651461014b578063d0e12f901461016f578063d3e5792b146101b0578063d4ff9218146101e457600080fd5b80630d9019e1146100805780633ccfd60b146100de57806354fd4d50146100f557600080fd5b3661007b57005b600080fd5b34801561008c57600080fd5b506100b47f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174281565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100ea57600080fd5b506100f3610217565b005b34801561010157600080fd5b5061013e6040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100d59190610671565b34801561015757600080fd5b5061016160005481565b6040519081526020016100d5565b34801561017b57600080fd5b506101a37f000000000000000000000000000000000000000000000000000000000000000081565b6040516100d591906106f5565b3480156101bc57600080fd5b506101617f0000000000000000000000000000000000000000000000008ac7230489e8000081565b3480156101f057600080fd5b507f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b4017426100b4565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102f2576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546103089190610709565b9091555050604080518281527f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b401742337f00000000000000000000000000000000000000000000000000000000000000006040516103f69493929190610748565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156104325761043261068b565b0361054b5760007f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d80600081146104b1576040519150601f19603f3d011682016040523d82523d6000602084013e6104b6565b606091505b5050905080610547576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102e9565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a39184916105d1917f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b4017429184916188b89190600401610789565b6000604051808303818588803b1580156105ea57600080fd5b505af11580156105fe573d6000803e3d6000fd5b505050505050565b6000815180845260005b8181101561062c57602081850181015186830182015201610610565b8181111561063e576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b6020815260006106846020830184610606565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106f1577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b6020810161070382846106ba565b92915050565b60008219821115610743577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff8481166020830152831660408201526080810161078060608301846106ba565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff831660408201526080606082015260006107ca6080830184610606565b969550505050505056fea164736f6c634300080f000a"

    # 두 번째 바이트코드 (사용자가 제공한 것)
    bytecode2 = "0x6080604052600436106100745760003560e01c806384411d651161004e57806384411d651461014b578063d0e12f901461016f578063d3e5792b146101b0578063d4ff9218146101e457600080fd5b80630d9019e1146100805780633ccfd60b146100de57806354fd4d50146100f557600080fd5b3661007b57005b600080fd5b34801561008c57600080fd5b506100b47f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e981565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100ea57600080fd5b506100f3610217565b005b34801561010157600080fd5b5061013e6040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100d59190610671565b34801561015757600080fd5b5061016160005481565b6040519081526020016100d5565b34801561017b57600080fd5b506101a37f000000000000000000000000000000000000000000000000000000000000000081565b6040516100d591906106f5565b3480156101bc57600080fd5b506101617f0000000000000000000000000000000000000000000000008ac7230489e8000081565b3480156101f057600080fd5b507f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e96100b4565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102f2576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546103089190610709565b9091555050604080518281527f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e9337f00000000000000000000000000000000000000000000000000000000000000006040516103f69493929190610748565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156104325761043261068b565b0361054b5760007f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d80600081146104b1576040519150601f19603f3d011682016040523d82523d6000602084013e6104b6565b606091505b5050905080610547576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102e9565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a39184916105d1917f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e99184916188b89190600401610789565b6000604051808303818588803b1580156105ea57600080fd5b505af11580156105fe573d6000803e3d6000fd5b505050505050565b6000815180845260005b8181101561062c57602081850181015186830182015201610610565b8181111561063e576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b6020815260006106846020830184610606565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106f1577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b6020810161070382846106ba565b92915050565b60008219821115610743577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff8481166020830152831660408201526080810161078060608301846106ba565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff831660408201526080606082015260006107ca6080830184610606565b969550505050505056fea164736f6c634300080f000a"

    # # BaseFeeVault
    # # 첫 번째 바이트코드 (첨부된 파일에서)
    # bytecode1 = "0x6080604052600436106100695760003560e01c806384411d651161004357806384411d6514610140578063d0e12f9014610164578063d3e5792b146101a557600080fd5b80630d9019e1146100755780633ccfd60b146100d357806354fd4d50146100ea57600080fd5b3661007057005b600080fd5b34801561008157600080fd5b506100a97f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174281565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100df57600080fd5b506100e86101d9565b005b3480156100f657600080fd5b506101336040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100ca9190610633565b34801561014c57600080fd5b5061015660005481565b6040519081526020016100ca565b34801561017057600080fd5b506101987f000000000000000000000000000000000000000000000000000000000000000081565b6040516100ca91906106b7565b3480156101b157600080fd5b506101567f0000000000000000000000000000000000000000000000008ac7230489e8000081565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546102ca91906106cb565b9091555050604080518281527f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b401742337f00000000000000000000000000000000000000000000000000000000000000006040516103b8949392919061070a565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156103f4576103f461064d565b0361050d5760007f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b40174273ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d8060008114610473576040519150601f19603f3d011682016040523d82523d6000602084013e610478565b606091505b5050905080610509576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102ab565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a3918491610593917f000000000000000000000000f90432b76a23bc7bb50b868dc4257c5f5b4017429184916188b8919060040161074b565b6000604051808303818588803b1580156105ac57600080fd5b505af11580156105c0573d6000803e3d6000fd5b505050505050565b6000815180845260005b818110156105ee576020818501810151868301820152016105d2565b81811115610600576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b60208152600061064660208301846105c8565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106b3577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b602081016106c5828461067c565b92915050565b60008219821115610705577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff84811660208301528316604082015260808101610742606083018461067c565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff8316604082015260806060820152600061078c60808301846105c8565b969550505050505056fea164736f6c634300080f000a"

    # # 두 번째 바이트코드 (사용자가 제공한 것)
    # bytecode2 = "0x6080604052600436106100695760003560e01c806384411d651161004357806384411d6514610140578063d0e12f9014610164578063d3e5792b146101a557600080fd5b80630d9019e1146100755780633ccfd60b146100d357806354fd4d50146100ea57600080fd5b3661007057005b600080fd5b34801561008157600080fd5b506100a97f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e981565b60405173ffffffffffffffffffffffffffffffffffffffff90911681526020015b60405180910390f35b3480156100df57600080fd5b506100e86101d9565b005b3480156100f657600080fd5b506101336040518060400160405280600581526020017f312e342e3100000000000000000000000000000000000000000000000000000081525081565b6040516100ca9190610633565b34801561014c57600080fd5b5061015660005481565b6040519081526020016100ca565b34801561017057600080fd5b506101987f000000000000000000000000000000000000000000000000000000000000000081565b6040516100ca91906106b7565b3480156101b157600080fd5b506101567f0000000000000000000000000000000000000000000000008ac7230489e8000081565b7f0000000000000000000000000000000000000000000000008ac7230489e800004710156102b4576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152604a60248201527f4665655661756c743a207769746864726177616c20616d6f756e74206d75737460448201527f2062652067726561746572207468616e206d696e696d756d207769746864726160648201527f77616c20616d6f756e7400000000000000000000000000000000000000000000608482015260a4015b60405180910390fd5b6000479050806000808282546102ca91906106cb565b9091555050604080518281527f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff166020820152338183015290517fc8a211cc64b6ed1b50595a9fcb1932b6d1e5a6e8ef15b60e5b1f988ea9086bba9181900360600190a17f38e04cbeb8c10f8f568618aa75be0f10b6729b8b4237743b4de20cbcde2839ee817f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e9337f00000000000000000000000000000000000000000000000000000000000000006040516103b8949392919061070a565b60405180910390a160017f000000000000000000000000000000000000000000000000000000000000000060018111156103f4576103f461064d565b0361050d5760007f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e973ffffffffffffffffffffffffffffffffffffffff168260405160006040518083038185875af1925050503d8060008114610473576040519150601f19603f3d011682016040523d82523d6000602084013e610478565b606091505b5050905080610509576040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152603860248201527f4665655661756c743a206661696c656420746f2073656e64204e61746976655460448201527f6f6b656e20746f204c322066656520726563697069656e74000000000000000060648201526084016102ab565b5050565b604080516020810182526000815290517fe56b44a30000000000000000000000000000000000000000000000000000000081527342000000000000000000000000000000000000109163e56b44a3918491610593917f000000000000000000000000d7d57ba9f40629d48c4009a87654cdda8a5433e99184916188b8919060040161074b565b6000604051808303818588803b1580156105ac57600080fd5b505af11580156105c0573d6000803e3d6000fd5b505050505050565b6000815180845260005b818110156105ee576020818501810151868301820152016105d2565b81811115610600576000602083870101525b50601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0169290920160200192915050565b60208152600061064660208301846105c8565b9392505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b600281106106b3577f4e487b7100000000000000000000000000000000000000000000000000000000600052602160045260246000fd5b9052565b602081016106c5828461067c565b92915050565b60008219821115610705577f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b500190565b84815273ffffffffffffffffffffffffffffffffffffffff84811660208301528316604082015260808101610742606083018461067c565b95945050505050565b73ffffffffffffffffffffffffffffffffffffffff8516815283602082015263ffffffff8316604082015260806060820152600061078c60808301846105c8565b969550505050505056fea164736f6c634300080f000a"


    analyze_differences(bytecode1, bytecode2)

if __name__ == "__main__":
    main()